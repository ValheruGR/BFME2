
  
;---------------------------------------------

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;													
;;    Originally from SEE-permission kindly granted by Nazgul      ;;
;;												
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

Object MordorCastleWallSegment

	// *** ART Parameters ***  
  SelectPortrait = BRAMordorWallSegment
  
	Draw = W3DScriptedModelDraw ModuleTag_Draw
		
		OkToChangeModelColor  = Yes
		UseStandardModelNames = Yes
    
		DefaultModelConditionState
			; Model = mbwall_skn //dolgulwall_n //dolgulwall //IBWallN
			Model				= mbwalln
			; Texture	= dolgolgate.tga IBFortress.tga
		End
		
		ModelConditionState = SNOW BUILD_PLACEMENT_CURSOR
			Model				= mbwalln
			Texture				= dolgolgate.tga dolgolgate_sn.tga
		End
    
		ModelConditionState = BUILD_PLACEMENT_CURSOR
			Model				= mbwalln
			; Texture	= dolgolgate.tga IBFortress.tga
		End
    
		IdleAnimationState
			BeginScript
				CurDrawableShowSubObject("ModuleTag_DrawFloor")
			EndScript
		End
    
    
		;------------ build up states---------------
		ModelConditionState = SNOW AWAITING_CONSTRUCTION
			; Model = IBWallN_A
			Model				= mbwalln_a
			Texture				= dolgolgate.tga dolgolgate_sn.tga
		End
		
		ModelConditionState   = AWAITING_CONSTRUCTION 
			Model				= mbwalln_a
			; Model               = IBWallN_A
			; Texture	= IBFortress.tga dolgolgate.tga
		End
    
		AnimationState        = AWAITING_CONSTRUCTION
			; Animation           =  DBWallN_A
				; AnimationName     =  IBWallN_A.IBWallN_A
				; AnimationMode     = MANUAL
				; AnimationBlendTime = 0
			; End
			Animation			= mbwalln_abld
				AnimationName		= mbwalln_askl.mbwalln_abld
				AnimationMode		= MANUAL
				AnimationBlendTime	= 0
			End
			Flags				  = START_FRAME_FIRST
			BeginScript
				CurDrawableHideSubObject("ModuleTag_DrawFloor")
			EndScript
		End
    
		; ModelConditionState   = UPGRADE_NUMENOR_STONEWORK ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
			; // Model               = IBWallN_A
			; // Texture	= IBFortress.tga dolgolgate.tga
			; Model				= mbwalln_a
			; ParticleSysBone			= NONE WallConstructDust FollowBone:Yes
		; End
    
		ModelConditionState = SNOW ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
			; Model = IBWallN_A
			; Texture	= IBFortress.tga dolgolgate_sn.tga
			Model				= mbwalln_a
			Texture				= dolgolgate.tga dolgolgate_sn.tga
		End
		
		ModelConditionState   = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
			; Model               = IBWallN_A
			; Texture	= IBFortress.tga dolgolgate.tga
			Model				= mbwalln_a
			ParticleSysBone			= NONE WallConstructDust FollowBone:Yes
		End
	    
		AnimationState        = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
			; Animation           = DBWallN_A
				; AnimationName     = IBWallN_A.IBWallN_A
				; AnimationMode     = MANUAL
				; AnimationBlendTime = 0
			; End
			Animation			= mbwalln_abld
				AnimationName		= mbwalln_askl.mbwalln_abld
				AnimationMode		= MANUAL
				AnimationBlendTime	= 0
			End
			Flags				  = START_FRAME_FIRST
			StateName			  = BeingConstructed
			ParticleSysBone   = NONE WallConstructDust FollowBone:Yes
			BeginScript
				CurDrawableHideSubObject("ModuleTag_DrawFloor")
				CurDrawablePlaySound("GondorBarracksBeginConstruction")
			EndScript
		End
    
		;------------- end build up states --------------;	  
    
    
		;------------- damaged states --------------;	  
    
		ModelConditionState  = DAMAGED
			; Model         = mbwall_skn //IBWallN_D1  
			; Texture	= dolgolgate.tga dolgolgate_d1.tga //ADDED FOR SEE!!!
			Model				= mbwalln_d1
		End
		AnimationState = DAMAGED
			Animation			= DamagedAnimation
				AnimationName		= mbwalln_d1.mbwalln_d1
				AnimationMode		= ONCE
      End
			EnteringStateFX	= FX_WallDamaged
		End	    
		
		ModelConditionState  = REALLYDAMAGED
			; Model         = mbwall_skn //IBWallN_D2
			; Texture	= dolgolgate.tga dolgolgate_d2.tga //ADDED FOR SEE!!!
			Model				= mbwalln_d2
			Texture	= dolgolgate_d.tga dolgolgate_d2.tga //ADDED FOR SEE!!!
		End
    AnimationState = REALLYDAMAGED
      ; Animation				=	RubbleAnimation
        ; AnimationName		=	 mbwall_skn.mbwall_skn //IBWallN_D2.IBWallN_D2
        ; AnimationMode		=	ONCE
      ; End
      Animation			= RubbleAnimation
				AnimationName		= mbwalln_d2.mbwalln_d2
				AnimationMode		= ONCE
			End
      EnteringStateFX	= FX_WallDamaged
		End
    
		; ModelConditionState			= COLLAPSING
			; Model				= mbwalln_d2
		; End
		; AnimationState				= COLLAPSING
      ; Animation			= RubbleAnimation
				; AnimationName		= mbwalln_d2.mbwalln_d2
				; AnimationMode		= ONCE
  			; End
  			; ParticleSysBone			  NONE WallDestructionDust
			; EnteringStateFX			= FX_StructureMediumCollapse
		; End
    
;--------------------------- Isengard Replacements    
		ModelConditionState  = COLLAPSING
			Model         = IBWallN_D3
			Texture	= IBfortress_d.tga dolgolgate_d3.tga
		End
		AnimationState = COLLAPSING
      Animation				=	RubbleAnimation
				AnimationName		=	 IBWallN_D3.IBWallN_D3
				AnimationMode		=	ONCE
      End
      ParticleSysBone NONE WallDestructionDust
		End
;--------------------------- Isengard Replacements end

		ModelConditionState  = RUBBLE
			Model         = None	;GBWall_Rubble  
		End  
		AnimationState				= RUBBLE
			BeginScript
				CurDrawableHideSubObject("ModuleTag_DrawFloor")
			EndScript
		End
    
		ModelConditionState  = POST_RUBBLE
			Model         = None	;GBWall_Rubble
		End
		AnimationState = POST_RUBBLE
		End
    
		ModelConditionState  = POST_COLLAPSE
			Model         = None
		End
		AnimationState = POST_COLLAPSE
		End 
    
		; ModelConditionState = UPGRADE_NUMENOR_STONEWORK  
			; // Model = mbwall_skn //dolgulwall_n //dolgulwall //IBWallN
			; Model				= mbwalln
		; End	 
		
		ModelConditionState = SNOW  
			; Model = mbwall_skn //dolgulwall_n //dolgulwall //IBWallN
			; Texture	= dolgolgate.tga dolgolgate_sn.tga //IBFortress.tga IBFortress_snow.tga
			Model				= mbwalln
			Texture				= dolgolgate.tga dolgolgate_sn.tga
		End	 
		
	End

	Draw = W3DScriptedModelDraw ModuleTag_Draw_Rubble
		OkToChangeModelColor  = Yes
		UseStandardModelNames = Yes
		DefaultModelConditionState
			Model = None
		End
	
		ModelConditionState  = COLLAPSING
			Model         = GBWall_Rubble
		End
		
		ModelConditionState  = RUBBLE
			Model         = GBWall_Rubble
		End
	    
		ModelConditionState  = POST_RUBBLE
			Model         = GBWall_Rubble
		End

		ModelConditionState  = POST_COLLAPSE
			Model         = None
		End
	End
  
	;//Morgul Sorcery
	Draw = W3DScriptedModelDraw ModuleTag_DrawMorgulSorcery
		OkToChangeModelColor	= Yes
    
		DefaultModelConditionState
			Model	= None
		End
    
		ModelConditionState	= UPGRADE_NUMENOR_STONEWORK
			Model = mbwalln_sor
		End
    
	End
  
	// ***DESIGN parameters ***
	DisplayName         = OBJECT:IsengardCastleWallSegment
	Side                = Mordor
	EditorSorting       = STRUCTURE
	ThreatLevel = 1.0
	 
	BuildCost           = ISENGARD_CASTLE_WALLSEGMENT_BUILDCOST
	BuildTime           = ISENGARD_CASTLE_WALLSEGMENT_BUILDTIME
	VisionRange         = 160.0          // Shroud clearing distance
	ShroudClearingRange = 160
	CommandSet			= MordorWallSegmentCommandSet

	// *** AUDIO Parameters ***

	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"

	VoiceSelect						= Gui_PlotSelect2
    VoiceSelectUnderConstruction	= BuildingEvilVoiceSelectUnderConstruction

	SoundOnDamaged					= BuildingLightDamageStone
	SoundOnReallyDamaged			= BuildingHeavyDamageStone

    UnitSpecificSounds
        UnderConstruction		= WallConstructionLoop  ; Built first time
		; UnderRepairFromDamage	= NoSound					; Repaired No animation on the building, so don't bother playing sound
		UnderRepairFromRubble	= WallConstructionLoop	; Repaired from completely destroyed (not used???)
    End

	ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_PlayCollapseSound
		ModelCondition = REQUIRED:RUBBLE Sound:BuildingSink
	End

	CampnessValue = CAMPNESS_WALL

	// *** ENGINEERING Parameters ***
	RadarPriority       = STRUCTURE
	KindOf              = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE WALL_SEGMENT SCALEABLE_WALL MADE_OF_STONE
	ThreatBreakdown ThreatBreakdown_ModuleTag
		AIKindOf = WALL
	End
	 
	//This is important to let the user select the rubble to begin self repair
	KeepSelectableWhenDead	= Yes
 
	Behavior            = GettingBuiltBehavior ModuleTag_04
		SelfBuildingLoop			= WallConstructionLoop			// Only played if we DON'T spawn a worker
		SelfRepairFromDamageLoop	= NoSound						// This doesn't cause an animation, so don't bother playing a sound
		SelfRepairFromRubbleLoop	= WallConstructionLoop
		UseSpawnTimerWithoutWorker 		= Yes
		SpawnTimer	= DEFAULT_STRUCTURE_HEALDELAY
		RebuildTimeSeconds			= ISENGARD_CASTLE_WALLSEGMENT_BUILDTIME
	End

	Body                = StructureBody ModuleTag_05
		MaxHealth				= ELVEN_CASTLE_WALLSEGMENT_HEALTH
		MaxHealthDamaged		= ELVEN_CASTLE_WALLSEGMENT_HEALTH_DAMAGED
		MaxHealthReallyDamaged	= ELVEN_CASTLE_WALLSEGMENT_HEALTH_REALLY_DAMAGED
	End
 
	// These should always appear together on wall segments
	Behavior = KeepObjectDie ModuleTag_IWantRubble 
		DeathTypes			= ALL -SUICIDED
	End
	Behavior            = SlowDeathBehavior ModuleTag_SlowDeath
		DeathTypes			= NONE +SUICIDED
		DestructionDelay = 5000
	End												
	// These should always appear together on wall segments

	Behavior = ReplaceSelfUpgrade ModuleTag_Replace_With_Hub
		ReplaceWith				= MordorCastleWallHub
		TriggeredBy				= Upgrade_MordorWallHub
		ConflictsWith				= Upgrade_MordorWallRegularGate Upgrade_MordorWallTower Upgrade_MordorWallCatapult 
	End
		
	Behavior = ReplaceSelfUpgrade ModuleTag_Replace_With_Gate
		ReplaceWith				= MordorCastleWallGate
		TriggeredBy				= Upgrade_MordorWallRegularGate
		ConflictsWith				= Upgrade_MordorWallHub Upgrade_MordorWallTower Upgrade_MordorWallCatapult 
	End

	Behavior = ReplaceSelfUpgrade ModuleTag_Replace_With_Tower
		ReplaceWith				= MordorWallTowerSmall
		TriggeredBy				= Upgrade_MordorWallTower 
		ConflictsWith				= Upgrade_MordorWallHub Upgrade_MordorWallRegularGate Upgrade_MordorWallCatapult 
	End

	Behavior = ReplaceSelfUpgrade ModuleTag_Replace_With_Catapult
		ReplaceWith				= MordorWallCatapultSmall
		TriggeredBy				= Upgrade_MordorWallCatapult
		ConflictsWith				= Upgrade_MordorWallHub Upgrade_MordorWallRegularGate Upgrade_MordorWallTower 
	End


	Behavior = ProductionUpdate ModuleTag_RequiredForUpgradeProduction
	End
  
	Behavior = InheritUpgradeCreate ModuleTag_InheritStonework
		Radius = ALL_FORTRESS_WALL_EFFECTIVE_RADIUS
		Upgrade = Upgrade_MordorFortressMorgulSorcery
		ObjectFilter = ANY +MordorFortressCitadel
	End


	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced
		TriggeredBy				= Upgrade_MordorFortressMorgulSorcery
		AttributeModifier		= MorgulSorceryExpansion_Bonus		
	End

	Behavior = ModelConditionUpgrade ModuleTag_ShowThePlating
		TriggeredBy			= Upgrade_MordorFortressMorgulSorcery		
		AddConditionFlags	= UPGRADE_NUMENOR_STONEWORK
		Permanent			= Yes
	End
	
	ArmorSet
		Conditions        = None
		Armor             = IsenWallArmor
		DamageFX          = None
	End

	;//	Geometry for the temp men small wall segment
	Geometry              = BOX
	GeometryMajorRadius   = 5.0		;10.0 
	GeometryMinorRadius   = 20.0
	GeometryHeight        = 40.0	;47
	GeometryIsSmall       = No
	  
	;Geometry              = BOX
	;GeometryMajorRadius   = 25.0
	;GeometryMinorRadius   = 20.0
	;GeometryHeight        = 50
	;GeometryIsSmall       = No
  
	Shadow                = SHADOW_VOLUME
	BuildCompletion     = PLACED_BY_PLAYER

	; Behavior = FireWeaponWhenDeadBehavior ModuleTag_09
		; RequiredStatus	= DEATH_1
		; StartsActive	= Yes
		; DelayTime		= 100 
		; DeathWeapon		= KillWallSorceryWeaponWall_SEE
		; WeaponOffset	= X:0 Y:-10 Z:0
	; End

	; Behavior = GrantUpgradeCreate ModuleTag_ActLikeAnOldUpgrade		
		; UpgradeToGrant		= Upgrade_ObjectLevel1
		; GiveOnBuildComplete = Yes
	; End

	; Behavior = ObjectCreationUpgrade MaketheEagle
		; TriggeredBy				= Upgrade_ObjectLevel1
		; Delay					= 500.0
		; ThingToSpawn			= MorgulSorceryWallEgg_SEE
		; Offset				= X:0.0 Y:0.0 Z:-0.0
		; FadeInTime				= 500
	; End
End


;---------------------------------------------
Object MordorCastleWallHub
  
  ; *** ART Parameters ***
  
  SelectPortrait = BRAMordorWallHub
  
	Draw = W3DScriptedModelDraw ModuleTag_Draw
  
		OkToChangeModelColor  = Yes
		UseStandardModelNames = Yes
		DefaultModelConditionState
			; Model = dolgulhub //IBWallRmprtN
			Model				= mbwlhub
		End
		
		IdleAnimationState
      StateName = STATE_None
		End
    
    
		;------------ build up states---------------		
		ModelConditionState			= SNOW AWAITING_CONSTRUCTION
			; Model = dolgulhub //IBWallRmprtN_A
			; Texture	= dolgolgate.tga dolgolgate_sn.tga //IBFortress.tga IBFortress_snow.tga
			Model				= mbwlhub_a
			Texture				= dolgolgate.tga dolgolgate_sn.tga
		End
		ModelConditionState			= AWAITING_CONSTRUCTION 
			; Model               = dolgulhub //IBWallRmprtN_A
			Model				= mbwlhub_a
		End
		AnimationState				= AWAITING_CONSTRUCTION
			; Animation           =  dolgulwall_abld //DBWallN_A
				; AnimationName     =  dolgulhub.dolgulhub //IBWallRmprtN_A.IBWallRmprtN_A
				; AnimationMode     = MANUAL
				; AnimationBlendTime = 0
			; End
			Animation			= mbwlhub_abld
				AnimationName		= mbwlhub_askl.mbwlhub_abld
				AnimationMode		= MANUAL
				AnimationBlendTime	= 0
			End
			Flags				= START_FRAME_FIRST
		End
		
		ModelConditionState			= SNOW ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
			; Model = dolgulhub //IBWallRmprtN_A
			Model				= mbwlhub_a
			Texture				= dolgolgate.tga dolgolgate_sn.tga
		End
		ModelConditionState			= ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
			; Model               = dolgulhub //IBWallRmprtN_A
			Model				= mbwlhub_a
		End
		AnimationState				= ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
			; Animation           = dolgulhub //IBWallRmprtN_A
				; AnimationName     = dolgulhub.dolgulhub //IBWallRmprtN_A.IBWallRmprtN_A
				; AnimationMode     = MANUAL
				; AnimationBlendTime = 0
			; End
			Animation			= mbwlhub_abld
				AnimationName		= mbwlhub_askl.mbwlhub_abld
				AnimationMode		= MANUAL
				AnimationBlendTime	= 0
			End
			Flags				= START_FRAME_FIRST
			StateName			= BeingConstructed
			ParticleSysBone			= NONE WallConstructDust FollowBone:Yes
			BeginScript
				CurDrawablePlaySound("GondorBarracksBeginConstruction")
			EndScript
		End
    
    
		;--damaged building
	  
		ModelConditionState  = DAMAGED
			; Model         = dolgulhub_d1 //IBWallRmprtN_D1  
			; Texture	= dolgolgate.tga dolgolgate_d1.tga //ADDED FOR SEE!!!
			Model				= mbwlhub_d1
		End
		AnimationState = DAMAGED
			EnteringStateFX	= FX_BuildingDamaged ;FX_HubDamaged
		End	    
		
		ModelConditionState  = REALLYDAMAGED
			; Model         = dolgulhub_d2 //IBWallRmprtN_D2
			Model				= mbwlhub_d2
			Texture	= dolgolgate_d.tga dolgolgate_d2.tga //ADDED FOR SEE!!!
		End
    AnimationState = REALLYDAMAGED
      Animation			= RubbleAnimation
				AnimationName		= mbwlhub_d2.mbwlhub_d2
				AnimationMode		= ONCE
      End
      Animation				=	RubbleAnimation
        AnimationName		=	 dolgulhub_d2.dolgulhub_d2 //IBWallRmprtN_D2.IBWallRmprtN_D2
        AnimationMode		=	ONCE
      End
      EnteringStateFX	= FX_BuildingReallyDamaged ;FX_HubDamaged
		End
     
		; ModelConditionState			= COLLAPSING
			; //Model         = dolgulhub_d3 //IBWallRmprtN_D3
			; Model				= mbwlhub_d3
			; Texture	= dolgolgate_d.tga dolgolgate_d3.tga //ADDED FOR SEE!!!
		; End		
		; AnimationState				= COLLAPSING
      ; Animation			= RubbleAnimation
				; AnimationName		= mbwlhub_d3.mbwlhub_d3
				; AnimationMode		= ONCE
      ; End
      ; EnteringStateFX			= FX_StructureMediumCollapse
      ; ParticleSysBone			  NONE HubDestructionDust
		; End
    
		; ModelConditionState			= DYING
			; // Model         = dolgulhub_d3 //IBWallRmprtN_D3
			; Model				= mbwlhub_d3
			; Texture	= dolgolgate_d.tga dolgolgate_d3.tga //ADDED FOR SEE!!!
		; End		
		; AnimationState				= DYING
      ; Animation			= RubbleAnimation
				; AnimationName		= mbwlhub_d3.mbwlhub_d3
				; AnimationMode		= ONCE
      ; End
      ; EnteringStateFX			= FX_StructureMediumCollapse
      ; ParticleSysBone			  NONE HubDestructionDust
		; End
    
;----------------- Isengard Replacement
		ModelConditionState  = COLLAPSING
			Model         = IBWallRmprtN_D3
			Texture	= IBfortress_d.tga dolgolgate_d3.tga
		End
		
		AnimationState = COLLAPSING
      		Animation				=	RubbleAnimation
				AnimationName		=	 IBWallRmprtN_D3.IBWallRmprtN_D3
				AnimationMode		=	ONCE
  			End
  			ParticleSysBone NONE HubDestructionDust
  			EnteringStateFX	= FX_StructureMediumCollapse
		End
    
		ModelConditionState  = DYING
			Model         = IBWallRmprtN_D3
			Texture	= IBfortress_d.tga dolgolgate_d3.tga
		End
		
		AnimationState = DYING
      		Animation				=	RubbleAnimation
				AnimationName		=	 IBWallRmprtN_D3.IBWallRmprtN_D3
				AnimationMode		=	ONCE
  			End
  			ParticleSysBone NONE HubDestructionDust
  			EnteringStateFX	= FX_StructureMediumCollapse
		End
;----------------- Isengard Replacement end
		
		ModelConditionState  = RUBBLE
			Model         = None  
		End  
		
		ModelConditionState  = POST_RUBBLE
			Model         = NONE
		End
		AnimationState = POST_RUBBLE
		End
    
		ModelConditionState  = POST_COLLAPSE
		Model         = None
		End
		AnimationState = POST_COLLAPSE
		End 
    
		;ModelConditionState = UPGRADE_NUMENOR_STONEWORK //NOT USED!!!
		;	Model	= dolgulhub //IBWallRmprtN
		;	Texture	= IBFortress.tga IBFortress_U.tga
		;End
    
		ModelConditionState = SNOW  
			; Model = dolgulhub //IBWallRmprtN
			Model = mbwlhub
			Texture	= dolgolgate.tga dolgolgate_sn.tga //IBFortress.tga IBFortress_snow.tga
		End
    
	End
	
	;//Morgul Sorcery
	Draw = W3DScriptedModelDraw ModuleTag_DrawMorgulSorcery
		OkToChangeModelColor	= Yes

		DefaultModelConditionState
			Model	= None
		End

		ModelConditionState	= UPGRADE_NUMENOR_STONEWORK
			Model = mbwlhub_sor
		End
    
	End
   
	; ***DESIGN parameters ***
	RadarPriority       = STRUCTURE	
	DisplayName         = OBJECT:IsengardCastleWallHub
	Side                = Mordor
	EditorSorting       = STRUCTURE
	ThreatLevel = 1.0
	 
	BuildCost           = MORDOR_CASTLE_WALLHUB_BUILDCOST
	BuildTime           = MORDOR_CASTLE_WALLHUB_BUILDTIME
	VisionRange         = 160.0          ; Shroud clearing distance
	ShroudClearingRange = 160

	; ;
 	ArmorSet
		Conditions        = None
		Armor             = IsenWallArmor
		DamageFX          = None
	End

	CommandSet = MordorCastleWallHubCommandSet
	

	; *** AUDIO Parameters ***
	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"

    VoiceSelect						= NeutralWallHubSelect	;Gui_PlotSelect2
    VoiceSelectUnderConstruction	= BuildingEvilVoiceSelectUnderConstruction

	SoundOnDamaged					= BuildingLightDamageStone
	SoundOnReallyDamaged			= BuildingHeavyDamageStone

    UnitSpecificSounds
        UnderConstruction		= BuildingConstructionLoop  ; Built first time
		; UnderRepairFromDamage	= NoSound					; Repaired No animation on the building, so don't bother playing sound
		UnderRepairFromRubble	= BuildingConstructionLoop	; Repaired from completely destroyed (not used???)
    End

	ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_PlayCollapseSound
		ModelCondition = REQUIRED:COLLAPSING	 Sound:BuildingSink
	End

	CampnessValue = CAMPNESS_WALL

	; *** ENGINEERING Parameters ***
	RadarPriority       = STRUCTURE
	KindOf              = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE WALL_HUB MADE_OF_STONE WALL_UPGRADE
	ThreatBreakdown ThreatBreakdown_ModuleTag
		AIKindOf = WALL
	End
	 
	Behavior            = GettingBuiltBehavior ModuleTag_04
		UseSpawnTimerWithoutWorker 		= Yes
   		SpawnTimer	= DEFAULT_STRUCTURE_HEALDELAY
		;SelfBuildingLoop = BuildingConstructionLoop ; Only played if we DON'T spawn a worker
		SelfRepairFromDamageLoop  = WallConstructionLoop
		SelfRepairFromRubbleLoop  = BuildingConstructionLoop
	End

	Body                = StructureBody ModuleTag_05
		MaxHealth				= ISENGARD_CASTLE_WALLHUB_HEALTH
		MaxHealthDamaged		= ISENGARD_CASTLE_WALLHUB_HEALTH_DAMAGED
		MaxHealthReallyDamaged	= ISENGARD_CASTLE_WALLHUB_HEALTH_REALLY_DAMAGED
	End
 

	Behavior				= SlowDeathBehavior ModuleTag_SlowDeath
		DeathTypes			= ALL
		DestructionDelay	= 5000
		;Sound				= INITIAL BuildingSink
	End
	
	Behavior = WallHubBehavior ModuleTag_WALL_HUB
		Options = OPTION_ONE
		MaxBuildoutDistance = ALL_FORTRESS_WALL_EFFECTIVE_RADIUS
		StaggeredBuildFactor = STANDARD_WALL_STAGGERED_BUILD_FACTOR
		SegmentTemplateName = MordorCastleWallSegment
		SegmentTemplateName = MordorCastleWallSegment	
		SegmentTemplateName = MordorCastleWallSegment
		SegmentTemplateName = MordorCastleWallSegment
		SegmentTemplateName = MordorCastleWallSegment
		SegmentTemplateName = MordorCastleWallHub
		BuilderRadius = 20
		HubCapTemplateName = MordorCastleWallHub
		DefaultSegmentTemplateName = MordorCastleWallSegment 
		CliffCapTemplateName = MordorWallCliffCap
	End

	Behavior = TerrainResourceBehavior ModuleTag_NewMoneyDeadSpot
		Radius			= 60		;// How far we try to claim ground
		MaxIncome		= 0			;// If we were to get all we wanted, how much we would earn.  Linear slope to 0 at 0% claim
		IncomeInterval	= 999999	;// How often (in msec) we give that much money
		HighPriority	= Yes		;// A high priority claim gets to pretend it was there first.
		Visible = No 		;// Don't show decal when a resource building is selected.
	End

	

	Behavior = InheritUpgradeCreate ModuleTag_InheritStonework
		Radius = ALL_FORTRESS_WALL_EFFECTIVE_RADIUS
		Upgrade = Upgrade_MordorFortressMorgulSorcery
		ObjectFilter = ANY +MordorFortressCitadel
	End

	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced
		TriggeredBy				= Upgrade_MordorFortressMorgulSorcery
		AttributeModifier		= MorgulSorceryExpansion_Bonus		
	End

	Behavior = ModelConditionUpgrade ModuleTag_ShowThePlating
		TriggeredBy			= Upgrade_MordorFortressMorgulSorcery
		AddConditionFlags	= UPGRADE_NUMENOR_STONEWORK
		Permanent			= Yes
	End	
	
	ArmorSet
		Conditions        = None
		Armor             = IsenWallArmor
		DamageFX          = None
	End

	;//	Geometry for the temp small men wall hub
	Geometry              = CYLINDER
	GeometryMajorRadius   = 20.0 ; 
	GeometryMinorRadius   = 20.0 ; 
	GeometryHeight        = 70.0
	GeometryIsSmall       = No

	AdditionalGeometry    = BOX
	GeometryMajorRadius   = 5.0		;10.0 
	GeometryMinorRadius   = 20.0
	GeometryHeight        = 40.0	;47
	GeometryIsSmall       = No
	
	Shadow                = SHADOW_VOLUME
	BuildCompletion     = PLACED_BY_PLAYER
	
	GeometryContactPoint = X:-21		Y:22		Z:0			Repair
	GeometryContactPoint = X:23		Y:-20		Z:0			Repair
	GeometryContactPoint = X:5.576		Y:44.987	Z:0
	GeometryContactPoint = X:-38.348	Y:-42.113	Z:0
	GeometryContactPoint = X:-28.448	Y:-0.003	Z:75.14		Swoop
End


//-------------OUTER-WALL-SYSTEM-----------------
;;=;;
ChildObject MordorCastleWallSegmentOuter MordorCastleWallSegment

	Behavior = ReplaceSelfUpgrade ModuleTag_Replace_With_Hub
		ReplaceWith				= MordorCastleWallHubOuterContinues
		TriggeredBy				= Upgrade_MordorWallHub
		ConflictsWith				= Upgrade_MordorWallRegularGate Upgrade_MordorWallTower Upgrade_MordorWallCatapult 
	End
End

//------------------
; ;
ChildObject MordorCastleWallHubOuter MordorCastleWallHub ;;=;; revised
	Scale = 1.15 ;;=;; Im bigger because i act like a mini fortress.
	Body                = StructureBody ModuleTag_05	;;=;;
		MaxHealth				= MORDOR_CASTLE_OUTER_WALLHUB_HEALTH	;;=;;
		MaxHealthDamaged		= MORDOR_CASTLE_OUTER_WALLHUB_HEALTH_DAMAGED
		MaxHealthReallyDamaged	= MORDOR_CASTLE_OUTER_WALLHUB_HEALTH_REALLY_DAMAGED
	End
	BuildCost = MORDOR_CASTLE_WALLHUB_OUTER_BUILDCOST ;;=;;
	BuildTime = MORDOR_CASTLE_WALLHUB_OUTER_BUILDTIME ;;=;;
	CommandSet = MordorCastleOuterWallHubOuterCommandSet ;;=;; I build OPTION_TWO.

	Behavior = ProductionUpdate ProductionUpdateModuleTag
	End

	Behavior = GrantUpgradeCreate ModuleTag_ActLikeAnOldUpgrade
		UpgradeToGrant		= Upgrade_HubIsBuilt
		GiveOnBuildComplete = Yes
	End

	Behavior = ObjectCreationUpgrade ModuleTag_MaketheFakeFortress
		TriggeredBy		= Upgrade_HubIsBuilt		
		Delay			= 0
		
		;RemoveUpgrade	= Upgrade_HubIsNotBuilt
		ThingToSpawn	= OuterHubFakeFortress
		Offset			= X:0.0 Y:0.0 Z:0.0
		DestroyWhenSold 		= Yes
	End

	Behavior = WallHubBehavior ModuleTag_WALL_HUB
		Options = OPTION_ONE
		MaxBuildoutDistance = 6199 ; ;
		StaggeredBuildFactor = STANDARD_WALL_STAGGERED_BUILD_FACTOR
		SegmentTemplateName = MordorCastleWallSegmentOuter
		SegmentTemplateName = MordorCastleWallSegmentOuter
		SegmentTemplateName = MordorCastleWallSegmentOuter
		SegmentTemplateName = MordorCastleWallSegmentOuter
		SegmentTemplateName = MordorCastleWallSegmentOuter
		SegmentTemplateName = MordorCastleWallHubOuterContinues ;;=;;
		BuilderRadius = 20
		HubCapTemplateName = MordorCastleWallHubOuterContinues ;;=;;
		DefaultSegmentTemplateName = MordorCastleWallSegmentOuter
		CliffCapTemplateName = MordorWallCliffCap
	End

	Behavior = WallHubBehavior ModuleTag_WALL_HUB_TWO
		Options = OPTION_TWO
		MaxBuildoutDistance = ALL_OUTERHUB_WALL_EFFECTIVE_RADIUS
		StaggeredBuildFactor = STANDARD_WALL_STAGGERED_BUILD_FACTOR
		SegmentTemplateName = MordorCastleWallSegmentOuter
		SegmentTemplateName = MordorCastleWallSegmentOuter
		SegmentTemplateName = MordorCastleWallSegmentOuter
		SegmentTemplateName = MordorCastleWallSegmentOuter
		SegmentTemplateName = MordorCastleWallSegmentOuter
		SegmentTemplateName = MordorCastleWallHubOuterContinues ;;=;;
		BuilderRadius = 20
		HubCapTemplateName = MordorCastleWallHubOuterContinues ;;=;;
		DefaultSegmentTemplateName = MordorCastleWallSegmentOuter
		CliffCapTemplateName = MordorWallCliffCap
	End
End

//------------------

ChildObject MordorCastleWallHubOuterContinues MordorCastleWallHub ;;=;;
	CommandSet = MordorCastleOuterWallHubOuterCommandSet ;;=;; I BUILD OPTION_TWO

	Behavior = WallHubBehavior ModuleTag_WALL_HUB_TWO
		Options = OPTION_TWO
		MaxBuildoutDistance = ALL_OUTERHUB_WALL_EFFECTIVE_RADIUS
		StaggeredBuildFactor = STANDARD_WALL_STAGGERED_BUILD_FACTOR
		SegmentTemplateName = MordorCastleWallSegmentOuter
		SegmentTemplateName = MordorCastleWallSegmentOuter
		SegmentTemplateName = MordorCastleWallSegmentOuter
		SegmentTemplateName = MordorCastleWallSegmentOuter
		SegmentTemplateName = MordorCastleWallSegmentOuter
		SegmentTemplateName = MordorCastleWallHubOuterContinues ;;=;;
		BuilderRadius = 20
		HubCapTemplateName = MordorCastleWallHubOuterContinues ;;=;;
		DefaultSegmentTemplateName = MordorCastleWallSegmentOuter
		CliffCapTemplateName = MordorWallCliffCap
	End
End

;;----------------------------------------------------------------------------------;;

Object MordorCastleWallGate
   
   ; *** ART Parameters ***
   
   	SelectPortrait = BRAMordorWallGate //BPIWall_MainGate
   
 	Draw = W3DScriptedModelDraw ModuleTag_Draw
    
 		OkToChangeModelColor  = Yes
 		UseStandardModelNames = Yes
    
 		DefaultModelConditionState
 			; Model = dolgulmgate_skn //dolgulmgate_skn //IBWallGateN_SKN
 			Model			= mbwlgte
 		End
    
		; //------------ SNOW! Added for SEE! 		
		; ModelConditionState = SNOW AWAITING_CONSTRUCTION
			; Model = dolgulmgate_skn
			; Texture	= dolgolgate.tga dolgolgate_sn.tga
		; End

;--------- damage states for the gate

		ModelConditionState   = DAMAGED
			Model			= mbwlgte_d1
			; Model               = dolgulmgate_d1 //IBWallGateN_D1
		End
		
		ModelConditionState   = REALLYDAMAGED
			Model			= mbwlgte_d2
			; Model               = dolgulmgate_d2 //IBWallGateN_D2
		End
    
		; ModelConditionState  = COLLAPSING DOOR_1_OPENING
			; // Model			= mbwlgte_d3o
			; Model         = dolgulmgopen_d3 //IBWallGateN_D4
		; End
		; AnimationState = COLLAPSING DOOR_1_OPENING
      ; Animation				=	RubbleAnimation
				; AnimationName		=	 dolgulmgopen_d3.dolgulmgopen_d3 //IBWallGateN_D4.IBWallGateN_D4
				; AnimationMode		=	ONCE
      ; End
      ; // Animation		= RubbleAnimation
				; // AnimationName	= mbwlgte_d3o.mbwlgte_d3o
				; // AnimationMode	= ONCE
      ; // End
		; End
		
		; ModelConditionState  = COLLAPSING
			; Model         = dolgulmgate_d3 //IBWallGateN_D3
			; // Model			= mbwlgte_d3
		; End
		; AnimationState = COLLAPSING
      ; Animation				=	RubbleAnimation
				; AnimationName		=	 dolgulmgate_d3.dolgulmgate_d3 //IBWallGateN_D3.IBWallGateN_D3
				; AnimationMode		=	ONCE
      ; End
      ; // Animation		= RubbleAnimation
				; // AnimationName	= mbwlgte_d3.mbwlgte_d3
				; // AnimationMode	= ONCE
      ; // End
		; End
    
		; ModelConditionState  = DYING
			; Model         = dolgulmgate_d3 //IBWallGateN_D3
		; End
		; AnimationState = DYING
      ; Animation				=	RubbleAnimation
				; AnimationName		=	 dolgulmgate_d3.dolgulmgate_d3 //IBWallGateN_D3.IBWallGateN_D3
				; AnimationMode		=	ONCE
      ; End
      ; // Animation		= RubbleAnimation
				; // AnimationName	= mbwlgte_d3.mbwlgte_d3
				; // AnimationMode	= ONCE
      ; // End
      ; EnteringStateFX	= FX_StructureMediumCollapse
      ; ParticleSysBone NONE HubDestructionDust
		; End
    
;--------------------------- Isengard Replacements    
		ModelConditionState  = COLLAPSING DOOR_1_OPENING
			Model         = IBWallGateN_D4
			Texture	= IBFortress_D.tga DolGolGate_D.tga
		End
		AnimationState = COLLAPSING DOOR_1_OPENING
      Animation				=	RubbleAnimation
				AnimationName		=	 IBWallGateN_D4.IBWallGateN_D4
				AnimationMode		=	ONCE
      End
		End
		
		ModelConditionState  = COLLAPSING
			Model         = IBWallGateN_D3
			Texture	= IBFortress_D.tga dolgolgate_d1.tga
		End
		AnimationState = COLLAPSING
      Animation				=	RubbleAnimation
				AnimationName		=	 IBWallGateN_D3.IBWallGateN_D3
        AnimationMode		=	ONCE
      End
		End
    
		ModelConditionState  = DYING
			Model         = IBWallGateN_D3
			Texture	= IBFortress_D.tga dolgolgate_d1.tga
		End
		AnimationState = DYING
      Animation				=	RubbleAnimation
				AnimationName		=	 IBWallGateN_D3.IBWallGateN_D3
				AnimationMode		=	ONCE
      End
      EnteringStateFX	= FX_StructureMediumCollapse
      ParticleSysBone NONE HubDestructionDust
		End
;--------------------------- Isengard Replacements end    
    
		ModelConditionState  = RUBBLE
			Model         = None  
		End  
		
		ModelConditionState  = POST_RUBBLE
			Model         = NONE
			ParticleSysBone NONE SmokeBuildingMediumRubble
		End
		AnimationState = POST_RUBBLE
		End

		ModelConditionState  = POST_COLLAPSE
		Model         = None
			ParticleSysBone NONE SmokeBuildingMediumRubble
		End
		AnimationState = POST_COLLAPSE
		End 
    
    
;------ Door Animations
		
		AnimationState = DOOR_1_OPENING 
			Flags = START_FRAME_LAST
			StateName = Door_Open
			; Animation				=	Death
				; AnimationName		=	IBWallGateN_SKL.IBWallGateN_OP
				; AnimationMode		=	ONCE
			; End
			Animation		= Death
				AnimationName	= mbwlgte_skl.mbwlgte_opn
				AnimationMode	= ONCE
				AnimationBlendTime = 160
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Door_Close" then CurDrawableSetTransitionAnimState("TRANS_Closed_To_Open") end
			EndScript
		End
		TransitionState = TRANS_Closed_To_Open
			; Animation = Open 
				; AnimationName	=	IBWallGateN_SKL.IBWallGateN_OPN
				; AnimationMode	=	ONCE 
			; End
			Animation		= Open 
				AnimationName	= mbwlgte_skl.mbwlgte_op
				AnimationMode	= ONCE 
				AnimationBlendTime = 160
			End
		End
    
		AnimationState = DOOR_1_CLOSING 
			Flags = START_FRAME_LAST
			StateName = Door_Close
			; Animation				=	Death
				; AnimationName		=	IBWallGateN_SKL.IBWallGateN_CL
				; AnimationMode		=	ONCE
			; End
			Animation		= Death
				AnimationName	= mbwlgte_skl.mbwlgte_cls
				AnimationMode	= ONCE
				AnimationBlendTime = 160
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Door_Open" then CurDrawableSetTransitionAnimState("TRANS_Open_To_Closed") end
			EndScript
		End
		TransitionState = TRANS_Open_To_Closed
			; Animation = Open 
				; AnimationName	=	IBWallGateN_SKL.IBWallGateN_CLS
				; AnimationMode	=	ONCE 
			; End
			Animation		= Open 
				AnimationName	= mbwlgte_skl.mbwlgte_cl
				AnimationMode	= ONCE
				AnimationBlendTime = 160
			End
		End
		
		ModelConditionState = SNOW
			; Model = dolgulmgate_skn //IBWallGateN_SKN
			Model			= mbwlgte
			Texture	= dolgolgate.tga dolgolgate_sn.tga //Idolgolgate.tga dolgolgate.tga //IBFortress.tga IBFortress_snow.tga
		End
		
 	End


	;//Morgul Sorcery
	Draw = W3DScriptedModelDraw ModuleTag_DrawMorgulSorcery
		OkToChangeModelColor	= Yes

		DefaultModelConditionState
			Model	= None
		End

		ModelConditionState	= UPGRADE_NUMENOR_STONEWORK
			Model = mbwlgte_sor
		End
	End	
  
	PlacementViewAngle  = 180	
 

 
  ; ***DESIGN parameters ***
   DisplayName         = OBJECT:IsengardCastleWallGate
  Side                = Mordor
   EditorSorting       = STRUCTURE
   ThreatLevel = 1.0
  
   BuildCost           = ISENGARD_CASTLE_WALLGATE_BUILDCOST
   BuildTime           = ISENGARD_CASTLE_WALLGATE_BUILDTIME
   VisionRange         = 160.0          ; Shroud clearing distance
   ShroudClearingRange = 160

	; ;
 	ArmorSet
		Conditions        = None
		Armor             = IsenWallArmor ; ;FortressExpansionArmor
		DamageFX          = None
	End
   
   CommandSet			= CastleGateCommandSet
 
   ; *** AUDIO Parameters ***

	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"

	VoiceSelect						= GateSelect
    VoiceSelectUnderConstruction	= BuildingEvilVoiceSelectUnderConstruction

 	SoundOnDamaged					= BuildingLightDamageStone
 	SoundOnReallyDamaged			= BuildingHeavyDamageStone

    UnitSpecificSounds
        UnderConstruction		= BuildingConstructionLoop  ; Built first time
		; UnderRepairFromDamage	= NoSound					; Repaired No animation on the building, so don't bother playing sound
		UnderRepairFromRubble	= BuildingConstructionLoop	; Repaired from completely destroyed (not used???)
    End

	;ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_PlayCollapseSound
	;	ModelCondition = REQUIRED:RUBBLE Sound:BuildingSink
	;End

	CampnessValue = CAMPNESS_WALL

   ; *** ENGINEERING Parameters ***
   RadarPriority       = STRUCTURE
   KindOf              = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE WALL_UPGRADE MADE_OF_STONE BLOCKING_GATE WALL_GATE
  
	Behavior            = GettingBuiltBehavior ModuleTag_04
		SelfBuildingLoop			= WallConstructionLoop			// Only played if we DON'T spawn a worker
		SelfRepairFromDamageLoop	= NoSound						// This doesn't cause an animation, so don't bother playing a sound
		SelfRepairFromRubbleLoop	= WallConstructionLoop
		SpawnTimer					= -1.0							// Negative means no 'autoheal'
		RebuildTimeSeconds			= ISENGARD_CASTLE_WALLGATE_BUILDTIME
	End
 
	Body                = StructureBody ModuleTag_05
		MaxHealth				= ISENGARD_CASTLE_WALLGATE_HEALTH
		MaxHealthDamaged		= ISENGARD_CASTLE_WALLGATE_HEALTH_DAMAGED
		MaxHealthReallyDamaged	= ISENGARD_CASTLE_WALLGATE_HEALTH_REALLY_DAMAGED
	End
  
	Behavior            = SlowDeathBehavior ModuleTag_SlowDeath
		DeathTypes			= ALL
		DestructionDelay = 5000 
	End												
	
	Behavior = GateOpenAndCloseBehavior ModuleTag_GATE
		ResetTimeInMilliseconds			= 3000				;important! this must be longer than the gates animation, ir it will twitch
		OpenByDefault					= No
		PercentOpenForPathing			= 50
		SoundOpeningGateLoop			= GateOpenStart
		SoundClosingGateLoop			= GateCloseStart
		SoundFinishedOpeningGate		= GateOpenEnd
		SoundFinishedClosingGate		= GateCloseEnd
		TimeBeforePlayingOpenSound		= 9500
		TimeBeforePlayingClosedSound	= 9500
	End
	
	Behavior = FakePathfindPortalBehaviour ModuleTag_FAKEPATHFIND
		AllowEnemies			= No
		AllowNonSkirmishAIUnits	= No
	End
	
	Behavior = AIGateUpdate ModuleTage_AIGateUpdate
		TriggerWidthX = 200.0
		TriggerWidthY = 100.0
	End
	
	ArmorSet
		Conditions        = None
		Armor             = IsenWallArmor
		DamageFX          = None
	End
	
	;//	Geometry from small men wall gate
	GeometryIsSmall		  = No

	; right pillar
	Geometry              = BOX
	GeometryMajorRadius   = 10.0  
	GeometryMinorRadius   = 10.0  
	GeometryHeight        = 75
	GeometryOffset        = X:0 Y:50 Z:0
	
	; left pillar
	AdditionalGeometry    = BOX
	GeometryMajorRadius   = 10.0  
	GeometryMinorRadius   = 10.0  
	GeometryHeight        = 75
	GeometryOffset        = X:0 Y:-50 Z:0


	; Main
	AdditionalGeometry    = BOX
	GeometryName		  = "Closed"
	GeometryMajorRadius   = 9.0  
	GeometryMinorRadius   = 50.0  
	GeometryHeight        = 50
	
	; Left open
	AdditionalGeometry    = BOX
	GeometryName		  = "OpenLeft"
	GeometryMajorRadius   = 9.0  
	GeometryMinorRadius   = 10.0  
	GeometryHeight        = 40
	GeometryOffset        = X:0 Y:-30 Z:0
	
	; Right open
	AdditionalGeometry    = BOX
	GeometryName		  = "OpenRight"
	GeometryMajorRadius   = 9.0  
	GeometryMinorRadius   = 10.0  
	GeometryHeight        = 40
	GeometryOffset        = X:0 Y:30 Z:0
	
	// need some geometry points to tell enemy weapons where to hit.
	GeometryContactPoint = X:0	Y:50 Z:75
	GeometryContactPoint = X:0	Y:50 Z:10
	GeometryContactPoint = X:0	Y:-50 Z:10
	GeometryContactPoint = X:0	Y:-50 Z:75
	
 
	Shadow                = SHADOW_VOLUME
	BuildCompletion     = PLACED_BY_PLAYER


	;ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_PlayCollapseSound
	;	ModelCondition = REQUIRED:RUBBLE Sound:BuildingSink
	;End


	; Behavior            = SlowDeathBehavior ModuleTag_SlowDeath
		; DeathTypes			= ALL
		; DestructionDelay = 5000
    ; DeathFlags			= DEATH_1     ; Controls animation and weapon choice. Sets BOTH model condition and object status bits.
	; End												
	; Behavior = FireWeaponWhenDeadBehavior ModuleTag_09
		; RequiredStatus	= DEATH_1
		; StartsActive	= Yes
		; DelayTime		= 100 
		; DeathWeapon		= KillWallSorceryWeaponGate_SEE
		; WeaponOffset	= X:0 Y:-10 Z:0
	; End

	; Behavior = GrantUpgradeCreate ModuleTag_ActLikeAnOldUpgrade		
		; UpgradeToGrant		= Upgrade_ObjectLevel1
		; GiveOnBuildComplete = Yes
	; End

	; Behavior = ObjectCreationUpgrade FreeSpace
		; TriggeredBy				= Upgrade_ObjectLevel1
		; Delay					= 100.0
		; ThingToSpawn			= MorgulSorceryWallGateFreeSpaceEgg_SEE
		; Offset				= X:0.0 Y:0.0 Z:-0.0
		; FadeInTime				= 500
	; End

	; Behavior = ObjectCreationUpgrade MaketheEagle
		; TriggeredBy				= Upgrade_ObjectLevel1
		; Delay					= 1000.0
		; ThingToSpawn			= MorgulSorceryWallGateEgg_SEE
		; Offset				= X:0.0 Y:0.0 Z:-0.0
		; FadeInTime				= 500
	; End


	Behavior = InheritUpgradeCreate ModuleTag_InheritStonework
		Radius = ALL_FORTRESS_WALL_EFFECTIVE_RADIUS
		Upgrade = Upgrade_MordorFortressMorgulSorcery
		ObjectFilter = ANY +MordorFortressCitadel
	End

	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced
		TriggeredBy				= Upgrade_MordorFortressMorgulSorcery
		AttributeModifier		= MorgulSorceryExpansion_Bonus		
	End

	Behavior = ModelConditionUpgrade ModuleTag_ShowThePlating
		TriggeredBy			= Upgrade_MordorFortressMorgulSorcery		
		AddConditionFlags	= UPGRADE_NUMENOR_STONEWORK
		Permanent			= Yes
	End
End
   
   
;----------------------------------------------------------------------
Object MordorWallCliffCap

	SelectPortrait  =  BRAMordorWallSegment
  
  ; *** ART Parameters ***
	
  Draw = W3DScriptedModelDraw ModuleTag_Draw
  
		OkToChangeModelColor  = Yes
		UseStandardModelNames = Yes
    
		DefaultModelConditionState
			; Model = mbwall_skn //IBWallNE
			Model = mbwalln
		End
		
		IdleAnimationState
      StateName = STATE_None
		End
    
    
    //------------ New Build Up States coming soon. 		
		ModelConditionState = SNOW AWAITING_CONSTRUCTION
			; Model = mbwall_skn //IBWallNE_A
			Model = mbwalln
			Texture	= dolgolgate.tga dolgolgate_sn.tga //IBFortress.tga IBFortress_snow.tga
		End
		ModelConditionState   = AWAITING_CONSTRUCTION 
			; Model               = mbwall_skn //IBWallNE_A
			Model               = mbwalln_a
		End
		AnimationState        = AWAITING_CONSTRUCTION
			; Animation           =  mbwall_skn //IBWallNE_A
				; AnimationName     =  mbwall_skn.mbwall_skn //IBWallNE_A.IBWallNE_A
				; AnimationMode     = MANUAL
				; AnimationBlendTime = 0
			; End
			Animation           =  mbwalln_abld
				AnimationName     =  mbwalln_askl.mbwalln_abld
				AnimationMode     = MANUAL
				AnimationBlendTime = 0
			End
			Flags				  = START_FRAME_FIRST
		End

		;ModelConditionState	= UPGRADE_NUMENOR_STONEWORK ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED //NOT USED!!!
		;	Model	= IBWallNE_A
		;	Texture	= IBFortress.tga IBFortress_U.tga
		;End
		
		ModelConditionState = SNOW ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
			; Model = mbwall_skn //IBWallNE_A
			Model               = mbwalln_a
			Texture	= dolgolgate.tga dolgolgate_sn.tga //IBFortress.tga IBFortress_snow.tga
		End
		ModelConditionState   = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
			; Model               = mbwall_skn //IBWallNE_A
			Model               = mbwalln_a
		End
		AnimationState        = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
			; Animation           = mbwall_skn //IBWallNE_A
				; AnimationName     = mbwall_skn.mbwall_skn //IBWallNE_A.IBWallNE_A
				; AnimationMode     = MANUAL
				; AnimationBlendTime = 0
			; End
			Animation           = mbwalln_abld
				AnimationName     = mbwalln_askl.mbwalln_abld
				AnimationMode     = MANUAL
				AnimationBlendTime = 0
			End
			Flags				  = START_FRAME_FIRST
			StateName			  = BeingConstructed
			ParticleSysBone   = NONE WallConstructDust FollowBone:Yes
		End
		
		;--damaged building
	  
		ModelConditionState  = DAMAGED
			; Model         = mbwall_skn //IBWallNE_D1
			; Texture	= dolgolgate.tga dolgolgate_d1.tga //ADDED FOR SEE!!!
			Model				= mbwalln_d1
		End
		AnimationState = DAMAGED
			EnteringStateFX	= FX_WallDamaged
		End	    
		
		ModelConditionState  = REALLYDAMAGED
			; Model         = mbwall_skn //IBWallNE_D2
			Model   = mbwalln_d2
			Texture	= dolgolgate_d.tga dolgolgate_d2.tga //ADDED FOR SEE!!!
		End
    AnimationState = REALLYDAMAGED
      ; Animation				=	RubbleAnimation
        ; AnimationName		=	 mbwall_skn.mbwall_skn //IBWallNE_D2.IBWallNE_D2
        ; AnimationMode		=	ONCE
      ; End
      Animation			= RubbleAnimation
				AnimationName		= mbwalln_d2.mbwalln_d2
				AnimationMode		= ONCE
      End
      EnteringStateFX	= FX_WallDamaged
		End
    
;--------------------------- Isengard Replacements    
		ModelConditionState  = COLLAPSING
			Model         = IBWallNE_D3
			Texture	= IBFortress.tga dolgolgate_d3.tga //ADDED FOR SEE!!!
		End
		AnimationState = COLLAPSING
      		Animation				=	RubbleAnimation
				AnimationName		=	 IBWallNE_D3.IBWallNE_D3
				AnimationMode		=	ONCE
  			End
  			ParticleSysBone NONE WallDestructionDust
			EnteringStateFX			= FX_StructureMediumCollapse
		End
;--------------------------- Isengard Replacements end
    
		; ModelConditionState  = COLLAPSING
			; Model         = mbwall_skn //IBWallNE_D3
			; Texture	= dolgolgate.tga dolgolgate_d3.tga //ADDED FOR SEE!!!
		; End
		; AnimationState = COLLAPSING
      ; Animation				=	RubbleAnimation
				; AnimationName		=	 mbwall_skn.mbwall_skn //IBWallNE_D3.IBWallNE_D3
				; AnimationMode		=	ONCE
      ; End
      ; ParticleSysBone NONE WallDestructionDust
			; EnteringStateFX			= FX_StructureMediumCollapse
		; End
    
		ModelConditionState  = RUBBLE
			Model         = None	;GBWall_Rubble  
		End  
		AnimationState = RUBBLE
		End
		
		ModelConditionState  = POST_RUBBLE
			Model         = None	;GBWall_Rubble
		End
		AnimationState = POST_RUBBLE
		End
    
		ModelConditionState  = POST_COLLAPSE
			Model         = None
		End
		AnimationState = POST_COLLAPSE
		End 
		
		;ModelConditionState = UPGRADE_NUMENOR_STONEWORK //NOT USED!!!
		;	Model	= IBWallNE
		;	Texture	= IBFortress.tga IBFortress_U.tga
		;End
		ModelConditionState = SNOW  
			; Model = mbwall_skn //IBWallNE
			Model = mbwalln
			Texture	= dolgolgate.tga dolgolgate_sn.tga //IBFortress.tga IBFortress_snow.tga
		End
    
	End
	
	;//Morgul Sorcery
	Draw = W3DScriptedModelDraw ModuleTag_DrawMorgulSorcery
		OkToChangeModelColor	= Yes
    
		DefaultModelConditionState
			Model	= None
		End
    
		ModelConditionState	= UPGRADE_NUMENOR_STONEWORK
			Model = mbwalln_sor
		End
    
	End	
  
  ; ***DESIGN parameters ***
  DisplayName         = OBJECT:IsengardWallCliffCap
  Side                = Mordor
  EditorSorting       = STRUCTURE
  ThreatLevel = 1.0
 
 
	CommandSet			= IsengardWallCliffCapCommandSet

 
  BuildCost           = MEN_WALLSEGMENT_SMALL_BUILDCOST
  BuildTime           = MEN_WALLSEGMENT_SMALL_BUILDTIME
  VisionRange         = MEN_WALLSEGMENT_SMALL_VISION_RANGE
  ShroudClearingRange = MEN_WALLSEGMENT_SMALL_SHROUD_CLEAR

  ; *** AUDIO Parameters ***
	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"
	SoundOnDamaged		= BuildingLightDamageStone
	SoundOnReallyDamaged	= BuildingHeavyDamageStone
    VoiceSelectUnderConstruction	= BuildingEvilVoiceSelectUnderConstruction

    UnitSpecificSounds
        UnderConstruction		= WallConstructionLoop  ; Built first time
		; UnderRepairFromDamage	= NoSound					; Repaired No animation on the building, so don't bother playing sound
		UnderRepairFromRubble	= WallConstructionLoop	; Repaired from completely destroyed (not used???)
    End

	;ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_PlayCollapseSound
	;	ModelCondition = REQUIRED:RUBBLE Sound:BuildingSink
	;End

	CampnessValue = CAMPNESS_WALL

  ; *** ENGINEERING Parameters ***
  RadarPriority       = STRUCTURE
  KindOf              = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE DEFENSIVE_WALL MADE_OF_STONE ; ;CAN_CAST_REFLECTIONS
   ThreatBreakdown ThreatBreakdown_ModuleTag
	AIKindOf = WALL
   End
 
  Behavior            = GettingBuiltBehavior ModuleTag_04
	UseSpawnTimerWithoutWorker 		= Yes
   	SpawnTimer	= DEFAULT_STRUCTURE_HEALDELAY
	SelfBuildingLoop = WallConstructionLoop ; Only played if we DON'T spawn a worker
	SelfRepairFromDamageLoop  = NoSound         ; This doesn't cause an animation, so don't bother playing a sound
	SelfRepairFromRubbleLoop  = WallConstructionLoop
  End

  Body                = StructureBody ModuleTag_05
		MaxHealth				= MEN_WALLSEGMENT_SMALL_HEALTH
		MaxHealthDamaged		= MEN_WALLSEGMENT_SMALL_HEALTH_DAMAGED
		MaxHealthReallyDamaged	= MEN_WALLSEGMENT_SMALL_HEALTH_REALLY_DAMAGED
  End
 
;  Behavior            = DestroyDie ModuleTag_07
;    ;nothing
;  End
	
	// These should always appear together on wall segments
	Behavior = KeepObjectDie ModuleTag_IWantRubble 
		DeathTypes			= ALL -SUICIDED
	End
	Behavior            = SlowDeathBehavior ModuleTag_SlowDeath
		DeathTypes			= NONE +SUICIDED
		DestructionDelay = 5000
	End	

	Behavior = ProductionUpdate ModuleTag_RequiredForUpgradeProduction
	End

	Behavior = InheritUpgradeCreate ModuleTag_InheritStonework
		Radius = ALL_FORTRESS_WALL_EFFECTIVE_RADIUS
		Upgrade = Upgrade_MordorFortressMorgulSorcery
		ObjectFilter = ANY +MordorFortressCitadel
	End

	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced
		TriggeredBy				= Upgrade_MordorFortressMorgulSorcery
		AttributeModifier		= MorgulSorceryExpansion_Bonus		
	End

	Behavior = ModelConditionUpgrade ModuleTag_ShowThePlating
		TriggeredBy			= Upgrade_MordorFortressMorgulSorcery		
		AddConditionFlags	= UPGRADE_NUMENOR_STONEWORK
		Permanent			= Yes
	End
	  
  ArmorSet
		Conditions        = None
		Armor             = IsenWallArmor
		DamageFX          = None
	End


	Geometry              	= BOX
	GeometryMajorRadius   	= 10.0 
	GeometryMinorRadius   	= 40.0   
	GeometryHeight			= 80
	GeometryIsSmall			= No
	GeometryOffset			= X:0 Y:-20 Z:-40
  
  Shadow                = SHADOW_VOLUME
  BuildCompletion     = PLACED_BY_PLAYER
End


;----------------------------------------------------------------------
Object MordorWallTowerSmall

	// *** ART Parameters ***
	SelectPortrait					= BPMBattleTower

	Draw = W3DScriptedModelDraw ModuleTag_Draw
		OkToChangeModelColor			= Yes
		UseStandardModelNames			= Yes
	
		ExtraPublicBone				= Arrow_01
		ExtraPublicBone				= Arrow_02
		ExtraPublicBone				= Arrow_03
		ExtraPublicBone				= Arrow_04
		ExtraPublicBone				= Arrow_05
		ExtraPublicBone				= Arrow_06
		ExtraPublicBone				= Arrow_07
		ExtraPublicBone				= Arrow_08

	
		DefaultModelConditionState
			Model				= mbwalltwrn
			WeaponLaunchBone		= PRIMARY ARROW_
		End

		//--------- Damage States
		ModelConditionState			= DAMAGED
			Model				= mbwalltwrn_D1
		End

		AnimationState				= DAMAGED
			Animation			= DamagedAnimation
				AnimationName		= mbwalltwrn_D1.mbwalltwrn_D1
				AnimationMode		= ONCE
 			End
		End	 

		ModelConditionState			= REALLYDAMAGED
			Model				= mbwalltwrn_D2
		End

		AnimationState				= REALLYDAMAGED
			Animation			= DamagedAnimation
				AnimationName		= mbwalltwrn_D2.mbwalltwrn_D2
				AnimationMode		= ONCE
 			End
		End	 
 
		ModelConditionState			= COLLAPSING
			Model				= mbwalltwrn_D3
		End

		AnimationState				= COLLAPSING
			Animation			= RubbleAnimation
				AnimationName		= mbwalltwrn_D3.mbwalltwrn_D3
				AnimationMode		= ONCE
			End
			EnteringStateFX			= FX_StructureMediumCollapse
		End

		ModelConditionState			= DYING
			Model				= mbwalltwrn_D3
		End

		AnimationState = DYING
			Animation			= RubbleAnimation
				AnimationName		= mbwalltwrn_D3.mbwalltwrn_D3
				AnimationMode		= ONCE
			End
			EnteringStateFX			= FX_StructureMediumCollapse
		End

		ModelConditionState			= RUBBLE
			Model				= None
			ParticleSysBone			SmokeLarge01 SmokeBuildingLarge
		End

		AnimationState				= RUBBLE
		End

		ModelConditionState			= POST_RUBBLE
			Model				= None
			ParticleSysBone			NONE SmokeBuildingMediumRubble
		End
		ModelConditionState			= POST_COLLAPSE
			Model				= None
			ParticleSysBone			NONE SmokeBuildingMediumRubble
		End

		ModelConditionState			= UPGRADE_NUMENOR_STONEWORK
			Model				= mbwalltwrn
;			Texture				= GBFortress1.tga GBFortress1_U.tga
		End	
		
		ModelConditionState			= SNOW 
			Model				= mbwalltwrn
			Texture				= dolgolgate.tga dolgolgate_sn.tga
		End	
				
	End

	;//Morgul Sorcery
	Draw = W3DScriptedModelDraw ModuleTag_DrawMorgulSorcery
		OkToChangeModelColor	= Yes

		DefaultModelConditionState
			Model	= None
		End

		ModelConditionState	= UPGRADE_NUMENOR_STONEWORK
			Model = mbwalln_sor
		End
	End	
 
	// ***DESIGN parameters ***
	DisplayName					= OBJECT:GondorCastleWallArrowTower
	Side						= Mordor
	EditorSorting       = STRUCTURE
	ThreatLevel			= 1.0
	 
	BuildCost           = DWARVEN_WALLTOWER_SMALL_BUILDCOST
	BuildTime           = DWARVEN_WALLTOWER_SMALL_BUILDTIME           ; in seconds
	VisionRange         = DWARVEN_WALLTOWER_SMALL_VISION_RANGE        ; Shroud clearing distance
	ShroudClearingRange = DWARVEN_WALLTOWER_SMALL_SHROUD_CLEAR

	CommandSet	= SellableCommandSet


	// *** AUDIO Parameters ***

	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"


	VoiceSelect					= NeutralArrowTowerSelect
	VoiceSelectUnderConstruction	= BuildingEvilVoiceSelectUnderConstruction

	SoundOnDamaged					= BuildingLightDamageStone
	SoundOnReallyDamaged			= BuildingHeavyDamageStone

	UnitSpecificSounds
		UnderConstruction		= WallConstructionLoop  	;Built first time
		; UnderRepairFromDamage	= NoSound					; Repaired No animation on the building, so don't bother playing sound
		UnderRepairFromRubble	= WallConstructionLoop		;Repaired from completely destroyed (not used???)
	End

	CampnessValue = CAMPNESS_WALL

	; *** ENGINEERING Parameters ***
	RadarPriority       = STRUCTURE
	KindOf              = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE MADE_OF_STONE CAN_ATTACK IGNORE_FOR_VICTORY WALL_UPGRADE
; ; 
	ArmorSet
		Conditions        = None
		Armor             = DwarvenWallArmor
		DamageFX          = None
	End

	WeaponSet
		Weapon					= PRIMARY CastleWallUpgradeBow
		Conditions				= None
		AutoChooseSources		= PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
 
	Behavior = AIUpdateInterface ModuleTag_SoWeCanUseWeapon
 		AutoAcquireEnemiesWhenIdle	= Yes
 		MoodAttackCheckRate			= 250
 	End

	ThreatBreakdown ModuleTag_DetailedThreat
		AIKindOf = WALL
	End
 
	Behavior = GettingBuiltBehavior ModuleTag_04
		UseSpawnTimerWithoutWorker 		= Yes
		SpawnTimer				= DEFAULT_STRUCTURE_HEALDELAY
		;RebuildTimeSeconds			= 30
		SelfBuildingLoop			= BuildingConstructionLoop	; Only played if we DON'T spawn a worker
		SelfRepairFromDamageLoop		= WallConstructionLoop
		SelfRepairFromRubbleLoop		= BuildingConstructionLoop
	End
 
	Body = StructureBody ModuleTag_05
		MaxHealth				= MEN_WALLTOWER_SMALL_HEALTH
		MaxHealthDamaged			= MEN_WALLTOWER_SMALL_HEALTH_DAMAGED
		MaxHealthReallyDamaged			= MEN_WALLTOWER_SMALL_HEALTH_REALLY_DAMAGED
	End		


	Behavior                  = StructureCollapseUpdate ModuleTag_StructureCollapseUpdate
		MinCollapseDelay        = 000
		MaxCollapseDelay        = 000
		CollapseDamping         = .5

		MaxShudder              = 0.6
		MinBurstDelay           = 250
		MaxBurstDelay           = 800
		BigBurstFrequency       = 4
		FXList                  = INITIAL   FX_StructureMediumCollapse
		CollapseHeight			= 140
	End
	 
	Behavior            = SlowDeathBehavior ModuleTag_SlowDeath
		DeathTypes			= ALL
		DestructionDelay	= 5000
	End		


	Behavior = InheritUpgradeCreate ModuleTag_InheritStonework
		Radius = ALL_FORTRESS_WALL_EFFECTIVE_RADIUS
		Upgrade = Upgrade_MordorFortressMorgulSorcery
		ObjectFilter = ANY +MordorFortressCitadel
	End
	    
	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced
		TriggeredBy				= Upgrade_MordorFortressMorgulSorcery
		AttributeModifier			= MorgulSorceryKeep_Bonus
		CustomAnimAndDuration			= AnimState:UPGRADE_NUMENOR_STONEWORK AnimTime:0
	End

	Behavior = ModelConditionUpgrade ModuleTag_ShowTheStones
		TriggeredBy				= Upgrade_MordorFortressMorgulSorcery
		AddConditionFlags			= UPGRADE_NUMENOR_STONEWORK
		Permanent				= Yes
	End

	GeometryIsSmall		= No
	
	Geometry		= BOX
	GeometryMajorRadius	= 15.0 
	GeometryMinorRadius	= 15.0 
	GeometryHeight		= 40.0
	
	AdditionalGeometry	= BOX
	GeometryMajorRadius	= 10.0 
	GeometryMinorRadius	= 10.0 
	GeometryHeight		= 50.0
	GeometryOffset		= X:0 Y:0 Z:40
	
	AdditionalGeometry	= BOX
	GeometryMajorRadius	= 10 
	GeometryMinorRadius	= 20
	GeometryHeight		= 40

	
	Shadow                = SHADOW_VOLUME
	BuildCompletion     = PLACED_BY_PLAYER
End

;---------------------------------------------
Object MordorWallCatapultSmall

	; *** ART Parameters ***
	SelectPortrait					= UPMordor_CatapultNew 

	Draw = W3DScriptedModelDraw ModuleTag_Draw
		OkToChangeModelColor			= Yes
		UseStandardModelNames			= Yes
		StaticModelLODMode			= yes ;// Will append M or L to the skin name depending on GameLOD

		DefaultModelConditionState
			Model				= mbwallcatn
		End

		WallBoundsMesh = P1

		IdleAnimationState
		End	

		;--damaged building
		ModelConditionState			= DAMAGED
			Model				= mbwallcatn_d1
		End

		AnimationState				= DAMAGED
			EnteringStateFX			= FX_BuildingDamaged
		End

		ModelConditionState			= REALLYDAMAGED
			Model				= mbwallcatn_d2
		End
	    
		AnimationState				= REALLYDAMAGED
			EnteringStateFX			= FX_BuildingReallyDamaged
			Animation			= RubbleAnimation
				AnimationName		= mbwallcatn_d2.mbwallcatn_d2
				AnimationMode		= ONCE
  			End
		End

		ModelConditionState			= RUBBLE
			Model				= mbwallcatn_d3
			ParticleSysBone			SmokeLarge01 SmokeBuildingLarge
		End
	    
		AnimationState				= RUBBLE
			EnteringStateFX			= FX_StructureMediumCollapse
			Animation			= RubbleAnimation
				AnimationName		= mbwallcatn_d3.mbwallcatn_d3
				AnimationMode		= ONCE
  			End
		End

		ModelConditionState			= POST_RUBBLE
			Model				= None
		End

		ModelConditionState			= POST_COLLAPSE
			Model				= None
		End

		ModelConditionState			= UPGRADE_NUMENOR_STONEWORK
			Model				= mbwallcatn
;			Texture				= GBFortress1.tga GBFortress1_U.tga
		End
		
		ModelConditionState			= SNOW 
			Model				= mbwallcatn
			Texture				= dolgolgate.tga dolgolgate_sn.tga
		End
					
	End	;//Morgul Sorcery

	Draw = W3DScriptedModelDraw ModuleTag_DrawMorgulSorcery
		OkToChangeModelColor	= Yes

		DefaultModelConditionState
			Model	= None
		End

		ModelConditionState	= UPGRADE_NUMENOR_STONEWORK
			Model = mbwlhub_sor
		End
	End	
 

	; ***DESIGN parameters ***
	DisplayName					= OBJECT:DoGoldurWallCatapultSmall
	Side						= Mordor
	EditorSorting       = STRUCTURE
	ThreatLevel = 1.0
	 
	BuildCost           = DWARVEN_WALLCATAPULT_SMALL_BUILDCOST
	BuildTime           = DWARVEN_WALLCATAPULT_SMALL_BUILDTIME           ; in seconds
	VisionRange         = DWARVEN_WALLCATAPULT_SMALL_VISION_RANGE          ; Shroud clearing distance
	ShroudClearingRange = DWARVEN_WALLCATAPULT_SMALL_SHROUD_CLEAR
; ; 
	ArmorSet
		Conditions        = None
		Armor             = DwarvenWallArmor
		DamageFX          = None
	End

	// *** AUDIO Parameters ***

	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"

	VoiceSelect					= DwarvenCatapultExpansionSelect
	VoiceSelectUnderConstruction	= BuildingEvilVoiceSelectUnderConstruction

	SoundOnDamaged					= BuildingLightDamageStone
	SoundOnReallyDamaged			= BuildingHeavyDamageStone

	UnitSpecificSounds
		UnderConstruction		= WallConstructionLoop  	;Built first time
		; UnderRepairFromDamage	= NoSound					; Repaired No animation on the building, so don't bother playing sound
		UnderRepairFromRubble	= WallConstructionLoop		;Repaired from completely destroyed (not used???)
	End

	CampnessValue = CAMPNESS_WALL

	// *** ENGINEERING Parameters ***
	RadarPriority       = STRUCTURE
	KindOf              = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE MADE_OF_STONE IGNORE_FOR_VICTORY WALL_UPGRADE // WALL_HUB
 
	Behavior            			= GettingBuiltBehavior ModuleTag_04
		UseSpawnTimerWithoutWorker 		= Yes
		SpawnTimer	= DEFAULT_STRUCTURE_HEALDELAY
		RebuildTimeSeconds			= 30
		SelfBuildingLoop			= WallConstructionLoop			;Only played if we DON'T spawn a worker
		SelfRepairFromDamageLoop 	= NoSound						;This doesn't cause an animation, so don't bother playing a sound
		SelfRepairFromRubbleLoop	= WallConstructionLoop
	End

	Body                = StructureBody ModuleTag_05
		MaxHealth				= DWARVEN_WALLCATAPULT_SMALL_HEALTH
		MaxHealthDamaged		= DWARVEN_WALLCATAPULT_SMALL_HEALTH_DAMAGED
		MaxHealthReallyDamaged	= DWARVEN_WALLCATAPULT_SMALL_HEALTH_REALLY_DAMAGED
	End

	Behavior = InheritUpgradeCreate ModuleTag_InheritStonework
		Radius			= ALL_FORTRESS_WALL_EFFECTIVE_RADIUS
		Upgrade			= Upgrade_MordorFortressMorgulSorcery
		ObjectFilter	= ANY +MordorFortressCitadel
	End

	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced
		TriggeredBy				= Upgrade_MordorFortressMorgulSorcery
		AttributeModifier			= MorgulSorceryExpansion_Bonus
		CustomAnimAndDuration			= AnimState:UPGRADE_NUMENOR_STONEWORK AnimTime:0
	End

	Behavior = ModelConditionUpgrade ModuleTag_ShowTheStones
		TriggeredBy				= Upgrade_MordorFortressMorgulSorcery
		AddConditionFlags			= UPGRADE_NUMENOR_STONEWORK
		Permanent				= Yes
	End
	//Catapult Behaviors
	Behavior = ProductionUpdate ProductionUpdateModuleTag
	End
	Behavior = GrantUpgradeCreate ModuleTag_ActLikeAnOldUpgrade
		UpgradeToGrant = Upgrade_TrebuchetTurret
		GiveOnBuildComplete = Yes // The ExemptStatus UnderConstruction hack doesn't work on foundation buildings.
	End
	Behavior = CommandSetUpgrade ModueTag_TrebCommandSet
		TriggeredBy				= Upgrade_TrebuchetTurret
		ConflictsWith				= Upgrade_HasWallTrebuchet 
		CommandSet				= MordorUpgradeCommandSetBuyNewCatapult
	End
	Behavior = CommandSetUpgrade ModueTag_TrebCommandSet3
		TriggeredBy			= Upgrade_HasWallTrebuchet Upgrade_TrebuchetTurret
		CommandSet			= SellableCommandSet
		RequiresAllTriggers	= Yes
	End
	Behavior = ObjectCreationUpgrade MakeTheFreeTreb
		TriggeredBy		= Upgrade_TrebuchetTurret
		Delay			= 0.0
		
		RemoveUpgrade	= Upgrade_WallTrebuchetButtonEnable
		GrantUpgrade	= Upgrade_HasWallTrebuchet
		DestroyWhenSold = Yes
		DeathAnimAndDuration = AnimState:DEATH_2 AnimTime:999999
		Offset			= X:0.0 Y:0.0 Z:51.0
	End
	Behavior = ObjectCreationUpgrade MakeTheFreeTreb2
		TriggeredBy				= Upgrade_HasWallTrebuchet
		ConflictsWith				= Upgrade_OpenGarrison Upgrade_PosternGate
		Delay					= 0.0
		RemoveUpgrade				= Upgrade_WallTrebuchetButtonEnable
		ThingToSpawn				= MordorWallCatapult
		Offset					= X:0.0 Y:0.0 Z:60.0
		FadeInTime				= 600
	End
	Behavior = SlaveWatcherBehavior WatchTheTreb
		RemoveUpgrade		= Upgrade_HasWallTrebuchet			//when our slave dies, remove this upgrade, so we can get the upgrade again.
		GrantUpgrade		= Upgrade_WallTrebuchetButtonEnable	//when our slave dies, enable the button that allows us to buy a new one
		ShareUpgrades		= Yes								//So He'll get our Flaming Munitions
	End

	Behavior				= SlowDeathBehavior ModuleTag_SlowDeath
		DeathTypes			= ALL
		DestructionDelay	= 5000
	End

	Behavior = StructureCollapseUpdate ModuleTag_StructureCollapseUpdate 
		MinCollapseDelay			= 000
		MaxCollapseDelay			= 000
		CollapseDamping				= .5
		MaxShudder				= 0.6
		MinBurstDelay				= 250
		MaxBurstDelay				= 800
		BigBurstFrequency			= 4
		FXList					= INITIAL   FX_StructureMediumCollapse
		FXList					= ALMOST_FINAL  FX_StructureAlmostCollapse
		DestroyObjectWhenDone			= Yes
		CollapseHeight				= 89
	End

	GeometryIsSmall					= No

	AdditionalGeometry	= CYLINDER
	GeometryMajorRadius	= 25.0 
	GeometryHeight		= 60.0
	
	Shadow			= SHADOW_VOLUME
	BuildCompletion		= PLACED_BY_PLAYER
End


;---------------------------------------------
Object MordorCastleWallTower

	;PlacementViewAngle  = -90

  ; *** ART Parameters ***
	Draw = W3DScriptedModelDraw ModuleTag_Draw
		OkToChangeModelColor  = Yes
		UseStandardModelNames = Yes
		DefaultModelConditionState
			;Model = DBWallTwr
			Model = dolgultower //GBWallTwr		;//	Replace this when the dwarven version is ready
		End
		
//		WallBoundsMesh = P1
;		RampMesh1 = R1
;		RampMesh2 = R2
		
		IdleAnimationState
			Flags = ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
			Animation				=	ReallyDamagedanimation
				AnimationName		=	 GBWallrampart.GBWallrampart
				AnimationMode		=	LOOP
   			End
   			StateName = STATE_None
		End	
		
	End
 
	; ***DESIGN parameters ***
	DisplayName         = OBJECT:DwarvenCastleWallSegment
	Side                = Mordor
	EditorSorting       = STRUCTURE
	ThreatLevel			= 1.0
	ThreatBreakdown ModuleTag_DetailedThreat
		AIKindOf = WALL
	End
	 
	BuildCost           = DWARVEN_WALLTOWER_SMALL_BUILDCOST
	BuildTime           = DWARVEN_WALLTOWER_SMALL_BUILDTIME           ; in seconds
	VisionRange         = DWARVEN_WALLTOWER_SMALL_VISION_RANGE          ; Shroud clearing distance
	ShroudClearingRange = DWARVEN_WALLTOWER_SMALL_SHROUD_CLEAR

	; *** AUDIO Parameters ***
		#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"
		SoundOnDamaged		= BuildingLightDamageStone
		SoundOnReallyDamaged	= BuildingHeavyDamageStone
		CampnessValue = CAMPNESS_WALL

	; *** ENGINEERING Parameters ***
	RadarPriority       = STRUCTURE
	KindOf              = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE MADE_OF_STONE CAN_ATTACK WALL_UPGRADE
; ; 
	ArmorSet
		Conditions        = None
		Armor             = DwarvenWallArmor
		DamageFX          = None
	End

 	WeaponSet
		Conditions			= None
		Weapon				= PRIMARY CastleWallUpgradeBow
		AutoChooseSources	= PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
	
	Behavior = AIUpdateInterface ModuleTag_SoWeCanUseWeapon
 		AutoAcquireEnemiesWhenIdle	= Yes
 		MoodAttackCheckRate			= 250
 	End
 
	Behavior            = GettingBuiltBehavior ModuleTag_04
		UseSpawnTimerWithoutWorker 		= Yes
		SpawnTimer	= DEFAULT_STRUCTURE_HEALDELAY
		RebuildTimeSeconds = 30
		SelfBuildingLoop = BuildingConstructionLoop ; Only played if we DON'T spawn a worker
		SelfRepairFromDamageLoop  = NoSound         ; This doesn't cause an animation, so don't bother playing a sound
		SelfRepairFromRubbleLoop  = BuildingConstructionLoop
	End

	Body                = StructureBody ModuleTag_05
		MaxHealth         = 1500.0
	End
	 
	// These should always appear together on wall segments
	Behavior = KeepObjectDie ModuleTag_IWantRubble 
		DeathTypes			= ALL -SUICIDED
	End
	Behavior            = SlowDeathBehavior ModuleTag_SlowDeath
		DeathTypes			= NONE +SUICIDED
		DestructionDelay	= 5000
	End												
	// These should always appear together on wall segments	
	GeometryIsSmall       = No

	Geometry              = BOX
	GeometryMajorRadius   = 25.0  
	GeometryMinorRadius   = 98.0 ; must be a multiple of 20
	GeometryHeight        = 50

	AdditionalGeometry    = CYLINDER
	GeometryMajorRadius   = 40.0 
	GeometryMinorRadius   = 40.0 
	GeometryHeight        = 50.0
	
	Shadow                = SHADOW_VOLUME
	BuildCompletion     = PLACED_BY_PLAYER
End

;---------------------------------------------
