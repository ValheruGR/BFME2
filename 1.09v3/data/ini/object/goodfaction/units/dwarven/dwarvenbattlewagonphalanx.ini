Object DwarvenBattleWagonPhalanx         ;//BALANCE DwarvenBattleWagonPhalanx
	;// *** ART Parameters ***

	;// This is required for garrisoned objects - please put in all objects.
	ButtonImage		= BDHallofWarriors_DwarvenPhalanx	
	SelectPortrait  = UPDwarven_Phalanx

	Draw = W3DScriptedModelDraw ModuleTag_01
		OkToChangeModelColor	= Yes		  
		StaticModelLODMode		= Yes
		
		DefaultModelConditionState
			Model		= DUPhalanxA_SKN
			Skeleton	= DUPhalanx_SKL 
		End

		ModelConditionState = PASSENGER_VARIATION_1
			Model		= DUPhalanxA_SKN
			Skeleton	= DUPhalanxA_SKL
		End

		ModelConditionState = PASSENGER_VARIATION_2
			Model		= DUPhalanxB_SKN
			Skeleton	= DUPhalanxB_SKL
		End
		
		AnimationState        				= STUNNED_FLAILING 
			Animation           			= FlyA
				AnimationName       		= DUPhalanx_FLYA
				AnimationMode       		= LOOP
			End
			Flags               			= RANDOMSTART
		End

		AnimationState 						= DYING SPLATTED
			Animation 						= Splatted_On_Ground
				AnimationName 				= DUPhalanx_LNDA
				AnimationMode 				= ONCE
			End
			EnteringStateFX					= FX_OrcHitGround
		End

		AnimationState						= DYING
			Animation						= DIEB
				AnimationName				= DUPhalanx_DIEA
				AnimationMode				= ONCE
			End			
		End
		
		AnimationState			= PASSENGER_VARIATION_1 STUNNED
			Animation			= Slatted_On_Ground
				AnimationName	= DUPhalanxA_LNDA
				AnimationMode 	= ONCE
			End
			EnteringStateFX		= FX_OrcHitGround
		End 
		
		AnimationState			= PASSENGER_VARIATION_2 STUNNED
			Animation			= Slatted_On_Ground
				AnimationName	= DUPhalanxB_LNDA
				AnimationMode 	= ONCE
			End
			EnteringStateFX		= FX_OrcHitGround
		End 


		AnimationState						= PASSENGER_VARIATION_2 HIT_REACTION
			Animation						= HITA
				AnimationName				= DUPhalanxB_HITA
				AnimationMode				= ONCE
			End
		End
		AnimationState						= PASSENGER_VARIATION_1 HIT_REACTION
			Animation						= HITA
				AnimationName				= DUPhalanxA_HITA
				AnimationMode				= ONCE
			End
		End
		;//--------------------normal animations---------------------------	    
		;// --- Attacking --- ;
		AnimationState							= FIRING_OR_PREATTACK_B PASSENGER_VARIATION_1
			Animation
				AnimationName					= DUPhalanxA_ATKA
				AnimationMode				= ONCE
				UseWeaponTiming				= Yes
			End
 		End
		AnimationState							= FIRING_OR_PREATTACK_A PASSENGER_VARIATION_1
			Animation
				AnimationName					= DUPhalanxA_ATKA
				AnimationMode				= ONCE
				UseWeaponTiming				= Yes
			End
		End
		AnimationState							= ATTACKING PASSENGER_VARIATION_1
			Animation							= ALERT
				AnimationName					= DUPhalanxA_IDLA ;;-;; ATKA
				AnimationMode					= LOOP
			End
			Flags								= RESTART_ANIM_WHEN_COMPLETE MAINTAIN_FRAME_ACROSS_STATES2
		End

		;// --- Moving --- ;
		AnimationState = TRANSPORT_MOVING PASSENGER_VARIATION_1
			Animation = Moving_1
				AnimationName = DUPhalanxA_RUNA
				AnimationMode = LOOP
			End			
		End
		AnimationState = TRANSPORT_STOPPED PASSENGER_VARIATION_1
			Animation = Moving_1
				AnimationName = DUPhalanxA_IDLA
				AnimationMode = LOOP
			End			
		End

		;// --- Transitions --- ;
		TransitionState       = TRANS_IdleToAttention PASSENGER_VARIATION_1
			Animation           = ATNA
				AnimationName     = DUPhalanxA_ATNA
				AnimationMode     = ONCE
			End
		End
 

		TransitionState       = TRANS_IdleToAttention PASSENGER_VARIATION_1
			Animation           = ATNA
				AnimationName     = DUPhalanxA_ATNC
				AnimationMode     = ONCE
			End
		End
 
		;//--------------------normal animations right---------------------------	    

		;// --- Attacking --- ;
		AnimationState = FIRING_OR_PREATTACK_B PASSENGER_VARIATION_2
			Animation
				AnimationName	= DUPhalanxB_SPCA
				AnimationMode	= ONCE
			End
 		End
		AnimationState = FIRING_OR_PREATTACK_A PASSENGER_VARIATION_2
			Animation
				AnimationName	= DUPhalanxB_ATKA
				AnimationMode	= LOOP
			End
			Flags	= RESTART_ANIM_WHEN_COMPLETE MAINTAIN_FRAME_ACROSS_STATES2
		End
		AnimationState = ATTACKING PASSENGER_VARIATION_2
			Animation = ALERT
				AnimationName	= DUPhalanxB_IDLA
				AnimationMode	= LOOP
			End
			Flags	= RESTART_ANIM_WHEN_COMPLETE MAINTAIN_FRAME_ACROSS_STATES2
		End

		;// --- Moving --- ;
		AnimationState = TRANSPORT_MOVING PASSENGER_VARIATION_2
			Animation = Moving_1
				AnimationName = DUPhalanxB_RUNA
				AnimationMode = LOOP
			End			
		End
		AnimationState = TRANSPORT_STOPPED PASSENGER_VARIATION_2
			Animation = Moving_1
				AnimationName = DUPhalanxB_IDLA
				AnimationMode = LOOP
			End			
		End

		;// --- Transitions --- ;
		TransitionState       = TRANS_IdleToSelected PASSENGER_VARIATION_2
			Animation           = ATNA
				AnimationName     = DUPhalanxB_ATNA
				AnimationMode     = ONCE
			End
		End
		TransitionState		= TRANS_SelectedToIdle PASSENGER_VARIATION_2
			Animation			= ATNC
				AnimationName	= DUPhalanxB_ATNC
				AnimationMode	= ONCE
				AnimationSpeedFactorRange = 0.8 1.0
			End
		End
 

		TransitionState       = TRANS_IdleToSelected PASSENGER_VARIATION_1
			Animation           = ATNA
				AnimationName     = DUPhalanxA_ATNA
				AnimationMode     = ONCE
			End
		End
		TransitionState		= TRANS_SelectedToIdle PASSENGER_VARIATION_1
			Animation			= ATNC
				AnimationName	= DUPhalanxA_ATNC
				AnimationMode	= ONCE
				AnimationSpeedFactorRange = 0.8 1.0
			End
		End
 
	;;
 		AnimationState						= PASSENGER_VARIATION_1 CAPTURING
			Animation						= CHRA
				AnimationName				= DUPhalanxA_CHRA
				AnimationMode				= LOOP
				AnimationPriority			= 5
			End						
 		End
		AnimationState        = PASSENGER_VARIATION_1 SELECTED
			StateName           = STATE_Selected
			Animation           = ATNB
				AnimationName     = DUPhalanxA_ATNB
				AnimationMode     = LOOP
			End

			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle" then CurDrawableSetTransitionAnimState("TRANS_IdleToSelected") end
			EndScript
		End
		AnimationState						= PASSENGER_VARIATION_1 EMOTION_AFRAID
			Animation						= FERA
				AnimationName				= DUPhalanxA_FERA
				AnimationMode				= LOOP
			End
 		End
 
 		AnimationState						= PASSENGER_VARIATION_1 EMOTION_POINTING
			Animation						= Pointing1A
				AnimationName				= DUPhalanxA_PNTA
				AnimationMode				= LOOP
			End
 		End
 		AnimationState						= PASSENGER_VARIATION_1 EMOTION_CELEBRATING
			Animation						= CHRA
				AnimationName				= DUPhalanxA_CHRA
				AnimationMode				= LOOP
				AnimationPriority			= 5
			End						
 		End
	;;
 		AnimationState						= PASSENGER_VARIATION_2 CAPTURING
			Animation						= CHRA
				AnimationName				= DUPhalanxB_CHRA
				AnimationMode				= LOOP
				AnimationPriority			= 5
			End						
 		End
		AnimationState        = PASSENGER_VARIATION_2 SELECTED
			StateName           = STATE_Selected
			Animation           = ATNB
				AnimationName     = DUPhalanxB_ATNB
				AnimationMode     = LOOP
			End

			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle" then CurDrawableSetTransitionAnimState("TRANS_IdleToSelected") end
			EndScript
		End
		AnimationState						= PASSENGER_VARIATION_2 EMOTION_AFRAID
			Animation						= FERA
				AnimationName				= DUPhalanxB_FERA
				AnimationMode				= LOOP
			End
 		End
 		AnimationState						= PASSENGER_VARIATION_2 EMOTION_POINTING
			Animation						= Pointing1A
				AnimationName				= DUPhalanxB_PNTA
				AnimationMode				= LOOP
			End
 		End
 		AnimationState						= PASSENGER_VARIATION_2 EMOTION_CELEBRATING
			Animation						= CHRA
				AnimationName				= DUPhalanxB_CHRA
				AnimationMode				= LOOP
				AnimationPriority			= 5
			End						
 		End
 		AnimationState					= EMOTION_TAUNTING
			Animation
				AnimationName			= DUPhalanxA_TNTA
				AnimationMode			= LOOP
			End
 		End
		
		
		;//--------------------idle animations---------------------------	    
		AnimationState = PASSENGER_VARIATION_1
			StateName				= STATE_Idle
			Animation = IDLA
				AnimationName		= DUPhalanxA_IDLA
				AnimationMode		= ONCE
				AnimationPriority	= 30
				AnimationBlendTime	= 15
			End
			Flags			= RESTART_ANIM_WHEN_COMPLETE			
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Planted"	then CurDrawableSetTransitionAnimState("Trans_Down_To_Up") return end
				if Prev == "STATE_Selected" or Prev == "Trans_Down_To_Up" then CurDrawableSetTransitionAnimState("TRANS_SelectedToIdle") end
			EndScript
		End	

		AnimationState = PASSENGER_VARIATION_2
			StateName				= STATE_Idle
			Animation = IDLA
				AnimationName		= DUPhalanxB_IDLA
				AnimationMode		= ONCE
				AnimationPriority	= 30
				AnimationBlendTime	= 15
			End			
			Flags			= RESTART_ANIM_WHEN_COMPLETE			
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Planted"	then CurDrawableSetTransitionAnimState("Trans_Down_To_Up") return end
				if Prev == "STATE_Selected" or Prev == "Trans_Down_To_Up" then CurDrawableSetTransitionAnimState("TRANS_SelectedToIdle") end
			EndScript
		End	
	End
  

	;// ***DESIGN parameters ***
	Side				= Dwarves
	EditorSorting		= UNIT
	ThreatLevel			= 1.0	
	CommandPoints		= 4 ;;-;; 0

	TransportSlotCount	= TRANSPORTSLOTCOUNT_UNIT
  
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    DwarvenBattleWagonPassengerPike 
		AutoChooseSources	= PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
	
	WeaponSet
		Conditions = PLAYER_UPGRADE
		Weapon = PRIMARY    DwarvenBattleWagonPassengerPikeUpgraded
		AutoChooseSources	= PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
	
	ArmorSet
		Conditions      = None
		Armor           = PikemenArmor
		DamageFX        = NormalDamageFX
	End
	
	ArmorSet
		Conditions      = PLAYER_UPGRADE
		Armor           = PikemenHeavyArmor
		DamageFX        = NormalDamageFX	
	End

  	;// This is required so that the build phase lasts as long as the anim.
	BuildFadeInOnCreateTime = 0 ;// 2.0 ;temporarily set to 0

	VisionSide = 50% ;;-;;
	VisionRear = 25% ;;-;;
	VisionRange				= DWARVEN_BATTLEWAGON_PASSENGERS_VISION_RANGE ;;=;; VISION_STANDARD_MELEE
	ShroudClearingRange		= DWARVEN_BATTLEWAGON_SHROUD_RANGE ;;=;; SHROUD_CLEAR_STANDARD
	
	DisplayName				= OBJECT:DwarvenBattleWagonPhalanx
	;;-;;	CrushableLevel			= 0  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	;;-;;	CrusherLevel			= 0 ;What can I crush?: 0 = small animals, 1 = infantry, 2 = trees, 3 = vehicles
 	CrushRevengeWeapon		= AntiCavalryInfantryCrushRevenge

 
	;// *** AUDIO Parameters ***;
    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

	;// *** ENGINEERING Parameters ***
	RadarPriority = UNIT
	KindOf = PASS_EXPERIENCE_TO_CONTAINER PRELOAD CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE 					ATTACK_NEEDS_LINE_OF_SIGHT NOT_AUTOACQUIRABLE UNATTACKABLE HIDE_IF_FOGGED SELECTABLE ;;-;;
 	ShockwaveResistance	= SHOCKWAVE_RESISTANCE_IMMUNE ;;-;; none ;;-;; SHOCKWAVE_RESISTANCE_ALWAYS


	Body = ActiveBody ModuleTag_02
		CheerRadius			= EMOTION_CHEER_RADIUS		
		MaxHealth			= 1
	End
	
	Behavior = AIUpdateInterface ModuleTag_03
		AutoAcquireEnemiesWhenIdle 		= Yes ATTACK_BUILDINGS
		AILuaEventsList			   		= GondorFighterFunctions    
		MoodAttackCheckRate        		= 500		
		AttackPriority					= AttackPriority_Spearman
		CanAttackWhileContained			= Yes
	End

	Behavior = PhysicsBehavior ModuleTag_04
		GravityMult = 1.0
		ShockStunnedTimeLow		= 1400	;msec
		ShockStunnedTimeHigh	= 2400	;msec
		ShockStandingTime		= 666	;msec
	End 

	LocomotorSet
  		Locomotor = HumanLocomotor
  		Condition = SET_NORMAL 
  		Speed     = 0
  	End
 
	Behavior = SlowDeathBehavior ModuleTag_05
		DeathTypes			= ALL -KNOCKBACK
		SinkDelay			= 3000
		SinkRate			= 0.40     ;// in Dist/Sec
		DestructionDelay		= 8000
		Sound				= INITIAL DwarfGenericVoiceDie
	End
 
	Behavior = SquishCollide ModuleTag_06
		;//nothing
	End
 
	Behavior = SlowDeathBehavior ModuleTag_07
		;// Same as normal death, but no sound (sound already played by SoundImpact = ... )
		DeathTypes			= NONE +KNOCKBACK
		SinkDelay			= 3000
		SinkRate			= 0.40     ;// in Dist/Sec
		DestructionDelay	= 8000
		;Sound				= INITIAL DwarfRhinocerousVoxDie
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
		TriggeredBy = Upgrade_DwarvenForgedBlades
	End
	
	;//Upgrades//
	Behavior = WeaponSetUpgrade WeaponSetUpgradeModuleTag
		TriggeredBy = Upgrade_DwarvenForgedBlades
	End
	
	Behavior = SubObjectsUpgrade ForgedBlade_Upgrade
		TriggeredBy		= Upgrade_DwarvenForgedBlades
		ShowSubObjects	= Forged_Blade
	End	
End
